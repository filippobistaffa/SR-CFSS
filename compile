#!/usr/bin/env bash

tmp=`mktemp`
basename="net/twitter-2010"
wg="wg"

cd /home/filippo/phd/rs
n=$(( $1 - 700 ))
limitclink=`grep $1,$2, /home/filippo/phd/rs/approx/clink/$1.csv | cut -d , -f 5`
#echo $limitclink
java -Xmx4000m -cp .:$wg/* ReduceGraph $basename $n $2 > $tmp
g++ -Wall -Wno-psabi -O2 -march=native -funroll-loops -fopenmp -funsafe-loop-optimizations -falign-functions=16 -falign-loops=16 \
-DSEED=$2ULL -DLIMITCLINK=$limitclink -include types.h -include $tmp *.c -o /tmp/$1-$2
rm $tmp
